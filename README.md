# CUDA RGB to Grayscale Conversion Kernels

This repository contains efficient CUDA implementations for converting RGB images to grayscale using the standard luminance formula:
`Y = 0.2989 * R + 0.5870 * G + 0.1140 * B`.

The project includes multiple kernel versions to demonstrate different optimization techniques and provides a test script for verification and benchmarking.

## Features

*   **Multiple Kernel Implementations:**
    *   Reference kernel (basic implementation).
    *   Optimized kernel using `float3` for vectorized memory access.
    *   Bonus kernel demonstrating shared memory usage.
*   **Performance Optimized:** Targets high performance on NVIDIA GPUs.
*   **Correctness Verification:** Output is compared against a NumPy-based calculation.
*   **Benchmarking:** Includes scripts to measure kernel execution time for various image sizes.
*   **Well-Documented:** Code and optimization techniques are explained.

## Directory Structure

```
.
├── .gitignore                 # Specifies intentionally untracked files that Git should ignore
├── LICENSE                    # Project license (MIT)
├── README.md                  # This file
├── rgb_to_grayscale_kernel.cu # CUDA C++ source code for the kernels
├── test_script.py             # Python script for testing and benchmarking
├── EXPLANATION.md             # Detailed explanation of concepts and optimizations
└── Signvrse_colab_notebook.ipynb # Google Colab notebook for interactive testing
```

## Requirements

*   NVIDIA GPU with CUDA support
*   CUDA Toolkit (for compiling and running CUDA C++ code)
*   Python 3.x
*   NumPy: `pip install numpy`
*   PyCUDA: `pip install pycuda`

## Setup and Running

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/EngEryx/signverse.git
    cd signverse
    ```

2.  **Ensure Prerequisites:** Install Python, NumPy, PyCUDA, and the CUDA Toolkit if you haven't already.

3.  **Run the Test Script:**
    The `test_script.py` will automatically compile the CUDA kernels from `rgb_to_grayscale_kernel.cu` and run the benchmarks.
    ```bash
    python test_script.py
    ```
    This will output correctness checks and performance measurements for different image sizes and kernel versions.

4.  **Using the Colab Notebook (Alternative):**
    You can also upload and run `Signvrse_colab_notebook.ipynb` in Google Colab. This provides an interactive environment with free GPU access for testing. The notebook embeds the CUDA code and performs the same tests.

## Kernels Implemented

*   **`rgb_to_grayscale_reference`**: A straightforward implementation where each thread loads R, G, and B components as separate float values.
*   **`rgb_to_grayscale_float3`**: An optimized version that uses the `float3` CUDA vector type to load RGB values. This promotes coalesced memory access, potentially improving bandwidth utilization.
*   **`rgb_to_grayscale_shared_mem`**: A bonus implementation that utilizes shared memory. Threads in a block first load a tile of the image into fast on-chip shared memory and then perform computations.

## Performance

The kernels are designed for efficiency. On a typical Google Colab GPU (e.g., NVIDIA T4), the optimized `float3` kernel achieves execution times well below 0.1 ms for a 1024x1024 image, outperforming the target baseline.

Actual performance results for various image sizes are generated by the `test_script.py` and are also available in the `Signvrse_colab_notebook.ipynb`.

## Optimization Techniques and Explanation

For a detailed discussion of the GPU architecture principles, CUDA programming concepts, and the optimization techniques employed in these kernels, please refer to [EXPLANATION.md](./EXPLANATION.md).

## Contributing

Contributions, issues, and feature requests are welcome. Feel free to check [issues page](https://github.com/EngEryx/signverse/issues) if you want to contribute.

## License

This project is licensed under the MIT License - see the [LICENSE](./LICENSE) file for details..